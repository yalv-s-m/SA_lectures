# Выполнение задач по расписанию в Linux и Windows

## Выполнение задач по расписанию в Linux

Для выполнения задач в Linux по расписанию используется служба **cron** или утилита **at**

1) Cron - это планировщик задач, используемый для выполнения задач (в фоновом режиме) в указанное время

    Crontab - команда, которая используется, для управления планировщиком Cron. Команда crontab создает файл crontab, содержащий команды и инструкции для запуска демона cron

    Файлы crontab пользователей именуются в соответствии с именем пользователя, и их расположение зависит от операционной системы. В дистрибутивах на основе Red Hat, таких как CentOS, файлы crontab хранятся в каталоге **/var/spool/cron**, а файлы Debian и Ubuntu хранятся в каталоге **/var/spool/cron/crontabs**

    Параметры crontab:

    - -e - редактирование или создание файла расписания для текущего пользователя
    - -l - вывод содержимого расписания текущего пользователя
    - -r - удаление файла расписания текущего пользователя
    - -u user - работа с расписаниями конкретных пользователей. Доступно только суперпользователю

    Каждая запись в crontab состоит из шести полей, указываемых в следующем порядке: **minute(s) hour(s) day(s) month(s) weekday(s) command(s)**

    Примеры использования:
    - Запуск скрипта каждый понедельник в 9:00 и 18:00 часов:

      - 0 9,18 * * 1 /home/ivan/script.sh
    - Запуск скрипта каждый день в 0:30 и 12:30:

      - 30 */12 * * * script.sh

2) at - это утилита командной строки, которая позволяет планировать выполнение команд в определенное время. Задания, созданные с помощью at, выполняются только один раз

    Синтаксис: **at [OPTION...] runtime**

    Давайте создадим задание, которое будет выполнено в 12:00 утра: **at 12:00**

    После того, как вы нажмете Enter, вы увидите командную строку at, которая чаще всего начинается с at>. Вы также видите предупреждение о том, что оболочка, в которой будет выполняться команда:

        warning: commands will be executed using /bin/sh
        at>

    Введите одну или несколько команд, которые вы хотите выполнить: **tar -xf /home/andreyex/file.tar.gz**

    Когда вы закончите ввод команд, нажмите Ctrl-D, чтобы выйти из командной строки и сохранить задание:

        at> <EOT>
        job 5 at Tue May  5 12:00:00 2020

    Команда отобразит номер задания, время выполнения и дату

## Выполнение задач по расписанию в Windows

Для регулярного выполнения задач в Windows используется планировщик задач (task scheduler). Он расположен в меню инструменты (tools) менеджера сервера (server manager) и в разделе администрирование меню "Пуск"

При создании нового задания появляется диалоговое окно, на вкладке общие (general) которого можно указать:

- имя задания
- описание задания
- пользователя, с правами которого оно будет выполняться

На вкладке **триггеры** задаётся время выполнения задачи, на вкладке **действия** - что выполнить. На вкладках **условия (conditions)** и **настройки (settings)** можно сделать более тонкие настройки времени выполнения задания

В качестве условий может фигурировать:

- время выполнения (как однократное, так и расписание)
- событие входа пользователя в систему, подключения и отключения от сессии удалённого доступа по протоколу RDP или событие из системного журнала

Дополнительно можно указать с какой даты по какую будет действовать это расписание
